(self.webpackChunkgeonode_mapstore_client=self.webpackChunkgeonode_mapstore_client||[]).push([[91701],{67007:(e,t,r)=>{"use strict";r.d(t,{en:()=>R,FU:()=>q,gs:()=>A,tt:()=>G,jY:()=>W,QQ:()=>$,B8:()=>k,T6:()=>I,ZP:()=>U});var n=r(72500),o=r.n(n),i=r(1469),a=r.n(i),u=r(84596),l=r.n(u),s=r(27361),c=r.n(s),p=r(41609),f=r.n(p),y=r(64721),d=r.n(y),m=r(44908),g=r.n(m),b=r(27418),v=r.n(b),h=r(5055),S=r.n(h),O=r(75875),w=r.n(O),L=r(37275),j=r(86267),x=r(96606);function P(e){return P="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},P(e)}function E(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function B(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?E(Object(r),!0).forEach((function(t){var n,o,i,a;n=e,o=t,i=r[t],a=function(e,t){if("object"!=P(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!=P(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(o),(o="symbol"==P(a)?a:String(a))in n?Object.defineProperty(n,o,{value:i,enumerable:!0,configurable:!0,writable:!0}):n[o]=i})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):E(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var C={},R=function(e){var t=(a()(e)&&e||e.split(","))[0],r=o().parse(t,!0);return o().format(v()({},r,{search:null},{query:v()({service:"WMS",version:"1.3.0",request:"GetCapabilities"},r.query)}))},M=function(e){var t=e&&e.Title,r=e.LogoURL&&B(B({},c()(e,"LogoURL.$")||{}),{},{format:c()(e,"LogoURL.Format")}),n=c()(e,'OnlineResource.$["xlink:href"]');return{title:t,logo:r,imageUrl:c()(e,'LogoURL.OnlineResource.$["xlink:href"]'),link:n}},T=function e(t){return t.Layer?(a()(t.Layer)&&t.Layer||[t.Layer]).reduce((function(t,r){return t.concat(e(r)).concat(r.Layer&&r.Name?[r]:[])}),[]):t.Name&&[t]||[]},D=function(){var e,t,r,n,o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=arguments.length>1?arguments[1]:void 0,u=arguments.length>2?arguments[2]:void 0,l=arguments.length>3?arguments[3]:void 0,s=(o.WMS_Capabilities||o.WMT_MS_Capabilities||{}).Capability,c=(o.WMS_Capabilities||o.WMT_MS_Capabilities||{}).Service,p=(n=s).Request&&n.Request.GetMap&&n.Request.GetMap.DCPType&&n.Request.GetMap.DCPType.HTTP&&n.Request.GetMap.DCPType.HTTP.Get&&n.Request.GetMap.DCPType.HTTP.Get.OnlineResource&&n.Request.GetMap.DCPType.HTTP.Get.OnlineResource.$||void 0,f=s.Layer&&(null===(e=s.Layer.SRS||s.Layer.CRS)||void 0===e?void 0:e.map((function(e){return e.toUpperCase()})))||[],y=s.Layer&&s.Layer.Attribution&&M(s.Layer.Attribution),d=s.Request&&s.Request.GetMap&&s.Request.GetMap.Format||[],m=T(s),g=(a()(m)?m:[m]).filter((function(e){return!l||-1!==e.Name.toLowerCase().indexOf(l.toLowerCase())||e.Title&&-1!==e.Title.toLowerCase().indexOf(l.toLowerCase())||e.Abstract&&-1!==e.Abstract.toLowerCase().indexOf(l.toLowerCase())}));return{numberOfRecordsMatched:g.length,numberOfRecordsReturned:Math.min(u,g.length),nextRecord:i+Math.min(u,g.length)+1,service:c,layerOptions:{version:(null===(t=o.WMS_Capabilities||o.WMT_MS_Capabilities)||void 0===t||null===(r=t.$)||void 0===r?void 0:r.version)||"1.3.0"},records:g.filter((function(e,t){return t>=i-1&&t<i-1+u})).map((function(e){return v()({},e,{formats:d,onlineResource:p,SRS:f,credits:e.Attribution?M(e.Attribution):y})}))}},q=function(e,t){var n=o().parse(e,!0),i=o().format(v()({},n,{query:v()({service:"WMS",version:"1.1.1",request:"GetCapabilities"},n.query)}));return new Promise((function(e){Promise.all([r.e(99942),r.e(67260)]).then(function(){var n=r(67260).unmarshaller;e(w().get(R(i)).then((function(e){var r;if(t)return S().parseString(e.data,{explicitArray:!1},(function(e,t){r=t})),r;var o=n.unmarshalString(e.data);return o&&o.value})))}.bind(null,r)).catch(r.oe)}))},_=function(e,t,r,n){var o=C[e];return o&&(new Date).getTime()<o.timestamp+1e3*((0,L.u8)("cacheExpire")||60)?new Promise((function(e){e(D(o.data,t,r,n))})):w().get(R(e)).then((function(o){var i;return S().parseString(o.data,{explicitArray:!1},(function(e,t){i=t})),C[e]={timestamp:(new Date).getTime(),data:i},D(i,t,r,n)}))},A=function(e,t){var r=o().parse(e,!0),n=o().format(v()({},r,{query:v()({service:"WMS",version:"1.1.1",layers:t,request:"DescribeLayer"},r.query)}));return w().get(R(n)).then((function(e){var t;return S().parseString(e.data,{explicitArray:!1},(function(e,r){t=r&&r.WMS_DescribeLayerResponse&&r.WMS_DescribeLayerResponse.LayerDescription})),(t=Array.isArray(t)?t:[t]).map((function(e){return B(B({},e&&e.$||{}),{},{layerName:e&&e.$&&e.$.name,query:B({},e&&e.query&&e.query.$||{})})}))}))},G=function(e,t,r,n){return _(e,t,r,n)},W=function(e,t){for(var r=e,n=r.EX_GeographicBoundingBox||r.exGeographicBoundingBox||(0,j.getWMSBoundingBox)(r.BoundingBox)||r.LatLonBoundingBox&&r.LatLonBoundingBox.$||r.latLonBoundingBox;!n&&r.Layer&&r.Layer.length;)n=(r=r.Layer[0]).EX_GeographicBoundingBox||r.exGeographicBoundingBox||(0,j.getWMSBoundingBox)(r.BoundingBox)||r.LatLonBoundingBox&&r.LatLonBoundingBox.$||r.latLonBoundingBox;n||(n={westBoundLongitude:-180,southBoundLatitude:-90,eastBoundLongitude:180,northBoundLatitude:90});var o={extent:[n.westBoundLongitude||n.minx,n.southBoundLatitude||n.miny,n.eastBoundLongitude||n.maxx,n.northBoundLatitude||n.maxy],crs:"EPSG:4326"};return t?{crs:o.crs,bounds:{minx:o.extent[0],miny:o.extent[1],maxx:o.extent[2],maxy:o.extent[3]}}:o},$=[{label:"image/png",value:"image/png"},{label:"image/png8",value:"image/png8"},{label:"image/jpeg",value:"image/jpeg"},{label:"image/vnd.jpeg-png",value:"image/vnd.jpeg-png"},{label:"image/vnd.jpeg-png8",value:"image/vnd.jpeg-png8"},{label:"image/gif",value:"image/gif"}],k=function(){return g()(Object.values((0,x.eq)()))},I=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return q(e).then((function(e){var r,n,o=c()(e,"capability.request.getMap.format",[]);if(f()(o))r=$;else{var i=$.map((function(e){return e.value}));r=(o=o.map((function(e){var t=e.value;return{label:t,value:t}}))).filter((function(e){var t=e.value;return d()(i,t)}))||[]}if(t){var a=c()(e,"capability.request.getFeatureInfo.format",[]),u=k();f()(a)?n=u:(a=a.map((function(e){return e.value})),n=g()(a.filter((function(e){return d()(u,e)})))||[])}return t?{imageFormats:r,infoFormats:n}:r})).catch((function(){return t?{imageFormats:$,infoFormats:k()}:$}))};const U={flatLayers:T,parseUrl:R,getDimensions:function(e){return l()(e.Dimension||e.dimension||[]).map((function(t,r){var n=e.Extent&&l()(e.Extent)[r]||e.extent&&l()(e.extent)[r];return{name:t.$.name,units:t.$.units,unitSymbol:t.$.unitSymbol,default:t.$.default||n&&n.$.default,values:t._&&t.split(",")||n&&n._&&n.split(",")}}))},getCapabilities:q,describeLayer:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=o().parse(e,!0),a=o().format(v()({},i,{query:v()({service:"WMS",version:"1.1.1",layers:t,request:"DescribeLayer"},i.query,n.query||{})}));return new Promise((function(e){Promise.all([r.e(99942),r.e(67260)]).then(function(){var t=r(67260).unmarshaller;e(w().get(R(a)).then((function(e){var r=t.unmarshalString(e.data);return r&&r.value&&r.value.layerDescription&&r.value.layerDescription[0]})))}.bind(null,r)).catch(r.oe)}))},getRecords:_,describeLayers:A,textSearch:G,parseLayerCapabilities:function e(t,r,n){return l()(n||c()(t,"capability.layer.layer")).reduce((function(n,o){return n||(!o.name&&o.layer?e(t,r,l()(o.layer)):2===r.name.split(":").length&&o.name&&2===o.name.split(":").length?r.name===o.name&&o:o.name&&2===o.name.split(":").length?r.name===o.name.split(":")[1]&&o:2===r.name.split(":").length?r.name.split(":")[1]===o.name&&o:r.name===o.name&&o)}),null)},getBBox:W,reset:function(){Object.keys(C).forEach((function(e){delete C[e]}))},getUniqueInfoFormats:k,getSupportedFormat:I}},98592:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>$});var n=r(1469),o=r.n(n),i=r(47037),a=r.n(i),u=r(27418),l=r.n(u),s=r(75263),c=r.n(s),p=r(24852),f=r.n(p),y=r(71703),d=r(67076),m=r(22222),g=r(80416),b=r(96909),v=r(15402),h=r(65539),S=r(82030),O=r(73014),w=r(32425),L=r(74621),j=r(93222),x=r(99009),P=r(78720);function E(e){return E="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},E(e)}function B(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function C(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?B(Object(r),!0).forEach((function(t){_(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):B(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function R(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,A(n.key),n)}}function M(e,t,r){return t=D(t),function(e,t){if(t&&("object"===E(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,T()?Reflect.construct(t,r||[],D(e).constructor):t.apply(e,r))}function T(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(T=function(){return!!e})()}function D(e){return D=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},D(e)}function q(e,t){return q=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},q(e,t)}function _(e,t,r){return(t=A(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function A(e){var t=function(e,t){if("object"!=E(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!=E(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==E(t)?t:String(t)}var G=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),M(this,t,arguments)}var r,n;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&q(e,t)}(t,e),r=t,(n=[{key:"UNSAFE_componentWillMount",value:function(){var e=!this.props.editingAllowedRoles||o()(this.props.editingAllowedRoles)&&a()(this.props.userRole)&&-1!==this.props.editingAllowedRoles.indexOf(this.props.userRole);this.props.onInit(this.props.styleService,e&&(0,x.uW)(this.props.layer,this.props.styleService))}},{key:"render",value:function(){return f().createElement(h.Z,{className:"ms-style-editor-container",header:this.props.showToolbar?f().createElement("div",{className:"ms-style-editor-container-header"},this.props.header,f().createElement("div",{className:"text-center"},f().createElement(P.lC,{enableSetDefaultStyle:this.props.enableSetDefaultStyle}))):null,footer:f().createElement("div",{style:{height:25}})},this.props.isEditing?f().createElement(P.m2,{config:this.props.editorConfig}):f().createElement(P.tM,{showDefaultStyleIcon:this.props.canEdit&&this.props.enableSetDefaultStyle}))}}])&&R(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),t}(f().Component);_(G,"propTypes",{layer:c().object,header:c().node,isEditing:c().bool,showToolbar:c().node.bool,onInit:c().func,styleService:c().object,userRole:c().string,editingAllowedRoles:c().array,enableSetDefaultStyle:c().bool,canEdit:c().bool,editorConfig:c().object}),_(G,"defaultProps",{layer:{},onInit:function(){},editingAllowedRoles:["ADMIN"],editorConfig:{}});var W=(0,d.compose)(d.toClass,(0,d.branch)((function(){return!(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).active}),(function(){return function(){return null}})),(0,y.connect)((0,m.P1)([j.ex,j.aN,j.Vf,j.p,L.L3,j.z_,j.Z0],(function(e,t,r,n,o,i,a){return{isEditing:"edit"===e,loading:t,layer:r,error:n,userRole:o,canEdit:i,styleService:a}})),{onInit:b.E0,onUpdateParams:g.Xy},(function(e,t,r){var n,o,i,a=(null===(n=r.styleService)||void 0===n?void 0:n.baseUrl)===(null===(o=e.styleService)||void 0===o?void 0:o.baseUrl)&&(null===(i=e.styleService)||void 0===i?void 0:i.isStatic),u=r.styleService&&!a?C(C({},r.styleService),{},{isStatic:!0}):C({},e.styleService);return C(C(C(C({},r),e),t),{},{styleService:u})})),(0,S.Z)((function(e){var t=e.error;return!!(null!=t&&t.availableStyles||null!=t&&t.global||null!=t&&t.parsingCapabilities)}),(function(e){var t=e.error;return{glyph:"exclamation-mark",title:f().createElement(v.Z,{msgId:"styleeditor.errorTitle"}),description:f().createElement(v.Z,{msgId:((null==t?void 0:t.availableStyles)?"styleeditor.missingAvailableStylesMessage":(null==t?void 0:t.parsingCapabilities)&&"styleeditor.parsingCapabilitiesError")||(null==t?void 0:t.global)&&"styleeditor.globalError"}),style:{display:"flex",width:"100%",height:"100%",overflow:"hidden"},mainViewStyle:{margin:"auto",width:300}}})),(0,O.Z)((function(e){return"global"===e.loading}),{size:150,style:{margin:"auto"}},(function(e){return f().createElement("div",{style:{position:"relative",height:"100%",display:"flex"}},f().createElement(w.Z,e))})),(0,d.compose)((0,y.connect)((function(){return{}}),{toggleStyleEditor:b.Wv}),(0,d.lifecycle)({componentDidMount:function(){this.props.toggleStyleEditor(null,!0)}})))(G);const $={StyleEditorPlugin:l()(W,{TOC:{priority:1,container:"TOCItemSettings"},TOCItemsSettings:{name:"StyleEditor",target:"style",priority:1,ToolbarComponent:P.lC}}),reducers:{styleeditor:r(32244).Z},epics:r(94943).ZP}},74621:(e,t,r)=>{"use strict";r.d(t,{np:()=>n,L3:()=>o,jl:()=>i,y8:()=>a,qg:()=>u}),r(27418),r(27361);var n=function(e){return e&&e.security&&e.security.user},o=function(e){return n(e)&&n(e).role},i=function(e){return e&&e.security&&e.security.user},a=function(e){return e.security&&e.security.token},u=function(e){return"ADMIN"===o(e)}}}]);