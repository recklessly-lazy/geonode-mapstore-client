(self.webpackChunkgeonode_mapstore_client=self.webpackChunkgeonode_mapstore_client||[]).push([[62875],{162875:(t,i,e)=>{"use strict";e.r(i),e.d(i,{default:()=>y});var o=e(949179),n=e(611256),s=e(438906),r=e(208913),h=e(613002),a=e(173381);const c="fraction";var _=e(85386),g=e(66575),l=e(516250),u=function(t){function i(i,e,o,n,s,r){t.call(this),this.hitDetectionImage_=null,this.image_=i||new Image,null!==n&&(this.image_.crossOrigin=n),this.canvas_=r?document.createElement("canvas"):null,this.color_=r,this.imageListenerKeys_=null,this.imageState_=s,this.size_=o,this.src_=e,this.tainted_}return t&&(i.__proto__=t),i.prototype=Object.create(t&&t.prototype),i.prototype.constructor=i,i.prototype.isTainted_=function(){if(void 0===this.tainted_&&this.imageState_===n.Z.LOADED){this.tainted_=!1;var t=(0,_.E4)(1,1);try{t.drawImage(this.image_,0,0),t.getImageData(0,0,1,1)}catch(t){this.tainted_=!0}}return!0===this.tainted_},i.prototype.dispatchChangeEvent_=function(){this.dispatchEvent(a.Z.CHANGE)},i.prototype.handleImageError_=function(){this.imageState_=n.Z.ERROR,this.unlistenImage_(),this.dispatchChangeEvent_()},i.prototype.handleImageLoad_=function(){this.imageState_=n.Z.LOADED,this.size_&&(this.image_.width=this.size_[0],this.image_.height=this.size_[1]),this.size_=[this.image_.width,this.image_.height],this.unlistenImage_(),this.replaceColor_(),this.dispatchChangeEvent_()},i.prototype.getImage=function(t){return this.canvas_?this.canvas_:this.image_},i.prototype.getImageState=function(){return this.imageState_},i.prototype.getHitDetectionImage=function(t){if(!this.hitDetectionImage_)if(this.isTainted_()){var i=this.size_[0],e=this.size_[1],o=(0,_.E4)(i,e);o.fillRect(0,0,i,e),this.hitDetectionImage_=o.canvas}else this.hitDetectionImage_=this.image_;return this.hitDetectionImage_},i.prototype.getSize=function(){return this.size_},i.prototype.getSrc=function(){return this.src_},i.prototype.load=function(){if(this.imageState_==n.Z.IDLE){this.imageState_=n.Z.LOADING,this.imageListenerKeys_=[(0,h.Vx)(this.image_,a.Z.ERROR,this.handleImageError_,this),(0,h.Vx)(this.image_,a.Z.LOAD,this.handleImageLoad_,this)];try{this.image_.src=this.src_}catch(t){this.handleImageError_()}}},i.prototype.replaceColor_=function(){if(this.color_&&!this.isTainted_()){this.canvas_.width=this.image_.width,this.canvas_.height=this.image_.height;var t=this.canvas_.getContext("2d");t.drawImage(this.image_,0,0);for(var i=t.getImageData(0,0,this.image_.width,this.image_.height),e=i.data,o=this.color_[0]/255,n=this.color_[1]/255,s=this.color_[2]/255,r=0,h=e.length;r<h;r+=4)e[r]*=o,e[r+1]*=n,e[r+2]*=s;t.putImageData(i,0,0)}},i.prototype.unlistenImage_=function(){this.imageListenerKeys_.forEach(h.bN),this.imageListenerKeys_=null},i}(g.Z);const p="bottom-left",f="bottom-right",m="top-left",d="top-right";var v=function(t){function i(i){var e=i||{},h=void 0!==e.opacity?e.opacity:1,a=void 0!==e.rotation?e.rotation:0,_=void 0!==e.scale?e.scale:1,g=void 0!==e.rotateWithView&&e.rotateWithView;t.call(this,{opacity:h,rotation:a,scale:_,rotateWithView:g}),this.anchor_=void 0!==e.anchor?e.anchor:[.5,.5],this.normalizedAnchor_=null,this.anchorOrigin_=void 0!==e.anchorOrigin?e.anchorOrigin:m,this.anchorXUnits_=void 0!==e.anchorXUnits?e.anchorXUnits:c,this.anchorYUnits_=void 0!==e.anchorYUnits?e.anchorYUnits:c,this.crossOrigin_=void 0!==e.crossOrigin?e.crossOrigin:null;var p=void 0!==e.img?e.img:null,f=void 0!==e.imgSize?e.imgSize:null,d=e.src;(0,s.h)(!(void 0!==d&&p),4),(0,s.h)(!p||p&&f,5),void 0!==d&&0!==d.length||!p||(d=p.src||(0,o.sq)(p)),(0,s.h)(void 0!==d&&d.length>0,6);var v=void 0!==e.src?n.Z.IDLE:n.Z.LOADED;this.color_=void 0!==e.color?(0,r._2)(e.color):null,this.iconImage_=function(t,i,e,o,n,s){var r=l.c.get(i,o,s);return r||(r=new u(t,i,e,o,n,s),l.c.set(i,o,s,r)),r}(p,d,f,this.crossOrigin_,v,this.color_),this.offset_=void 0!==e.offset?e.offset:[0,0],this.offsetOrigin_=void 0!==e.offsetOrigin?e.offsetOrigin:m,this.origin_=null,this.size_=void 0!==e.size?e.size:null}return t&&(i.__proto__=t),i.prototype=Object.create(t&&t.prototype),i.prototype.constructor=i,i.prototype.clone=function(){return new i({anchor:this.anchor_.slice(),anchorOrigin:this.anchorOrigin_,anchorXUnits:this.anchorXUnits_,anchorYUnits:this.anchorYUnits_,crossOrigin:this.crossOrigin_,color:this.color_&&this.color_.slice?this.color_.slice():this.color_||void 0,src:this.getSrc(),offset:this.offset_.slice(),offsetOrigin:this.offsetOrigin_,size:null!==this.size_?this.size_.slice():void 0,opacity:this.getOpacity(),scale:this.getScale(),rotation:this.getRotation(),rotateWithView:this.getRotateWithView()})},i.prototype.getAnchor=function(){if(this.normalizedAnchor_)return this.normalizedAnchor_;var t=this.anchor_,i=this.getSize();if(this.anchorXUnits_==c||this.anchorYUnits_==c){if(!i)return null;t=this.anchor_.slice(),this.anchorXUnits_==c&&(t[0]*=i[0]),this.anchorYUnits_==c&&(t[1]*=i[1])}if(this.anchorOrigin_!=m){if(!i)return null;t===this.anchor_&&(t=this.anchor_.slice()),this.anchorOrigin_!=d&&this.anchorOrigin_!=f||(t[0]=-t[0]+i[0]),this.anchorOrigin_!=p&&this.anchorOrigin_!=f||(t[1]=-t[1]+i[1])}return this.normalizedAnchor_=t,this.normalizedAnchor_},i.prototype.setAnchor=function(t){this.anchor_=t,this.normalizedAnchor_=null},i.prototype.getColor=function(){return this.color_},i.prototype.getImage=function(t){return this.iconImage_.getImage(t)},i.prototype.getImageSize=function(){return this.iconImage_.getSize()},i.prototype.getHitDetectionImageSize=function(){return this.getImageSize()},i.prototype.getImageState=function(){return this.iconImage_.getImageState()},i.prototype.getHitDetectionImage=function(t){return this.iconImage_.getHitDetectionImage(t)},i.prototype.getOrigin=function(){if(this.origin_)return this.origin_;var t=this.offset_;if(this.offsetOrigin_!=m){var i=this.getSize(),e=this.iconImage_.getSize();if(!i||!e)return null;t=t.slice(),this.offsetOrigin_!=d&&this.offsetOrigin_!=f||(t[0]=e[0]-i[0]-t[0]),this.offsetOrigin_!=p&&this.offsetOrigin_!=f||(t[1]=e[1]-i[1]-t[1])}return this.origin_=t,this.origin_},i.prototype.getSrc=function(){return this.iconImage_.getSrc()},i.prototype.getSize=function(){return this.size_?this.size_:this.iconImage_.getSize()},i.prototype.listenImageChange=function(t,i){return(0,h.oL)(this.iconImage_,a.Z.CHANGE,t,i)},i.prototype.load=function(){this.iconImage_.load()},i.prototype.unlistenImageChange=function(t,i){(0,h.Ev)(this.iconImage_,a.Z.CHANGE,t,i)},i}(e(548039).default);const y=v},516250:(t,i,e)=>{"use strict";e.d(i,{c:()=>r});var o=e(208913),n=function(){this.cache_={},this.cacheSize_=0,this.maxCacheSize_=32};function s(t,i,e){return i+":"+t+":"+(e?(0,o.XC)(e):"null")}n.prototype.clear=function(){this.cache_={},this.cacheSize_=0},n.prototype.expire=function(){if(this.cacheSize_>this.maxCacheSize_){var t=0;for(var i in this.cache_){var e=this.cache_[i];0!=(3&t++)||e.hasListener()||(delete this.cache_[i],--this.cacheSize_)}}},n.prototype.get=function(t,i,e){var o=s(t,i,e);return o in this.cache_?this.cache_[o]:null},n.prototype.set=function(t,i,e,o){var n=s(t,i,e);this.cache_[n]=o,++this.cacheSize_},n.prototype.setSize=function(t){this.maxCacheSize_=t,this.expire()};var r=new n}}]);