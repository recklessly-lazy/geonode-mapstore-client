(self.webpackChunkgeonode_mapstore_client=self.webpackChunkgeonode_mapstore_client||[]).push([[70515],{957043:(e,t,r)=>{var i=r(862488),n=r(121078),o=r(200278),s=r(701469);e.exports=function(){var e=arguments.length;if(!e)return[];for(var t=Array(e-1),r=arguments[0],a=e;a--;)t[a-1]=arguments[a];return i(s(r)?o(r):[r],n(t,1))}},701577:(e,t,r)=>{"use strict";r.d(t,{Z:()=>P});var i=r(949179),n=r(378426),o=r(919629),s=r(623068),a=r(30006),h=r(179682),u=r(690728),l=r(613002),g=r(9520),_=r(173381),d=r(436403),p=r(421915),c=r(28795),f=r(752043),v=r(938024),m=r(429902),y=r(973410),x=r(925753),E=r(273101),C=r(831219),F="modifyend",S=function(e){function t(t,r,i){e.call(this,t),this.features=r,this.mapBrowserEvent=i}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t}(g.ZP);function T(e,t){return e.index-t.index}function I(e,t){var r=t.geometry;if(r.getType()===c.Z.CIRCLE){var i=r;if(1===t.index){var n=(0,u.bI)(i.getCenter(),e),o=Math.sqrt(n)-i.getRadius();return o*o}}return(0,u.Bs)(e,t.segment)}function G(e,t){var r=t.geometry;return r.getType()===c.Z.CIRCLE&&1===t.index?r.getClosestPoint(e):(0,u.oL)(e,t.segment)}const P=function(e){function t(t){var r,i;if(e.call(this,t),this.condition_=t.condition?t.condition:d.Xp,this.defaultDeleteCondition_=function(e){return(0,d.Ko)(e)&&(0,d.Kf)(e)},this.deleteCondition_=t.deleteCondition?t.deleteCondition:this.defaultDeleteCondition_,this.insertVertexCondition_=t.insertVertexCondition?t.insertVertexCondition:d.Bx,this.vertexFeature_=null,this.vertexSegments_=null,this.lastPixel_=[0,0],this.ignoreNextSingleClick_=!1,this.modified_=!1,this.rBush_=new E.Z,this.pixelTolerance_=void 0!==t.pixelTolerance?t.pixelTolerance:10,this.snappedToVertex_=!1,this.changingFeature_=!1,this.dragSegments_=[],this.overlay_=new m.Z({source:new y.Z({useSpatialIndex:!1,wrapX:!!t.wrapX}),style:t.style?t.style:(r=(0,C.createEditingStyle)(),function(e,t){return r[c.Z.POINT]}),updateWhileAnimating:!0,updateWhileInteracting:!0}),this.SEGMENT_WRITERS_={Point:this.writePointGeometry_,LineString:this.writeLineStringGeometry_,LinearRing:this.writeLineStringGeometry_,Polygon:this.writePolygonGeometry_,MultiPoint:this.writeMultiPointGeometry_,MultiLineString:this.writeMultiLineStringGeometry_,MultiPolygon:this.writeMultiPolygonGeometry_,Circle:this.writeCircleGeometry_,GeometryCollection:this.writeGeometryCollectionGeometry_},this.source_=null,t.source?(this.source_=t.source,i=new n.Z(this.source_.getFeatures()),(0,l.oL)(this.source_,x.Z.ADDFEATURE,this.handleSourceAdd_,this),(0,l.oL)(this.source_,x.Z.REMOVEFEATURE,this.handleSourceRemove_,this)):i=t.features,!i)throw new Error("The modify interaction requires features or a source");this.features_=i,this.features_.forEach(this.addFeature_.bind(this)),(0,l.oL)(this.features_,o.Z.ADD,this.handleFeatureAdd_,this),(0,l.oL)(this.features_,o.Z.REMOVE,this.handleFeatureRemove_,this),this.lastPointerEvent_=null}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.addFeature_=function(e){var t=e.getGeometry();t&&t.getType()in this.SEGMENT_WRITERS_&&this.SEGMENT_WRITERS_[t.getType()].call(this,e,t);var r=this.getMap();r&&r.isRendered()&&this.getActive()&&this.handlePointerAtPixel_(this.lastPixel_,r),(0,l.oL)(e,_.Z.CHANGE,this.handleFeatureChange_,this)},t.prototype.willModifyFeatures_=function(e){this.modified_||(this.modified_=!0,this.dispatchEvent(new S("modifystart",this.features_,e)))},t.prototype.removeFeature_=function(e){this.removeFeatureSegmentData_(e),this.vertexFeature_&&0===this.features_.getLength()&&(this.overlay_.getSource().removeFeature(this.vertexFeature_),this.vertexFeature_=null),(0,l.Ev)(e,_.Z.CHANGE,this.handleFeatureChange_,this)},t.prototype.removeFeatureSegmentData_=function(e){var t=this.rBush_,r=[];t.forEach((function(t){e===t.feature&&r.push(t)}));for(var i=r.length-1;i>=0;--i)t.remove(r[i])},t.prototype.setActive=function(t){this.vertexFeature_&&!t&&(this.overlay_.getSource().removeFeature(this.vertexFeature_),this.vertexFeature_=null),e.prototype.setActive.call(this,t)},t.prototype.setMap=function(t){this.overlay_.setMap(t),e.prototype.setMap.call(this,t)},t.prototype.getOverlay=function(){return this.overlay_},t.prototype.handleSourceAdd_=function(e){e.feature&&this.features_.push(e.feature)},t.prototype.handleSourceRemove_=function(e){e.feature&&this.features_.remove(e.feature)},t.prototype.handleFeatureAdd_=function(e){this.addFeature_(e.element)},t.prototype.handleFeatureChange_=function(e){if(!this.changingFeature_){var t=e.target;this.removeFeature_(t),this.addFeature_(t)}},t.prototype.handleFeatureRemove_=function(e){var t=e.element;this.removeFeature_(t)},t.prototype.writePointGeometry_=function(e,t){var r=t.getCoordinates(),i={feature:e,geometry:t,segment:[r,r]};this.rBush_.insert(t.getExtent(),i)},t.prototype.writeMultiPointGeometry_=function(e,t){for(var r=t.getCoordinates(),i=0,n=r.length;i<n;++i){var o=r[i],s={feature:e,geometry:t,depth:[i],index:i,segment:[o,o]};this.rBush_.insert(t.getExtent(),s)}},t.prototype.writeLineStringGeometry_=function(e,t){for(var r=t.getCoordinates(),i=0,n=r.length-1;i<n;++i){var o=r.slice(i,i+2),s={feature:e,geometry:t,index:i,segment:o};this.rBush_.insert((0,p.hI)(o),s)}},t.prototype.writeMultiLineStringGeometry_=function(e,t){for(var r=t.getCoordinates(),i=0,n=r.length;i<n;++i)for(var o=r[i],s=0,a=o.length-1;s<a;++s){var h=o.slice(s,s+2),u={feature:e,geometry:t,depth:[i],index:s,segment:h};this.rBush_.insert((0,p.hI)(h),u)}},t.prototype.writePolygonGeometry_=function(e,t){for(var r=t.getCoordinates(),i=0,n=r.length;i<n;++i)for(var o=r[i],s=0,a=o.length-1;s<a;++s){var h=o.slice(s,s+2),u={feature:e,geometry:t,depth:[i],index:s,segment:h};this.rBush_.insert((0,p.hI)(h),u)}},t.prototype.writeMultiPolygonGeometry_=function(e,t){for(var r=t.getCoordinates(),i=0,n=r.length;i<n;++i)for(var o=r[i],s=0,a=o.length;s<a;++s)for(var h=o[s],u=0,l=h.length-1;u<l;++u){var g=h.slice(u,u+2),_={feature:e,geometry:t,depth:[s,i],index:u,segment:g};this.rBush_.insert((0,p.hI)(g),_)}},t.prototype.writeCircleGeometry_=function(e,t){var r=t.getCenter(),i={feature:e,geometry:t,index:0,segment:[r,r]},n={feature:e,geometry:t,index:1,segment:[r,r]},o=[i,n];i.featureSegments=n.featureSegments=o,this.rBush_.insert((0,p.HK)(r),i),this.rBush_.insert(t.getExtent(),n)},t.prototype.writeGeometryCollectionGeometry_=function(e,t){for(var r=t.getGeometriesArray(),i=0;i<r.length;++i)this.SEGMENT_WRITERS_[r[i].getType()].call(this,e,r[i])},t.prototype.createOrUpdateVertexFeature_=function(e){var t=this.vertexFeature_;return t?t.getGeometry().setCoordinates(e):(t=new s.Z(new f.Z(e)),this.vertexFeature_=t,this.overlay_.getSource().addFeature(t)),t},t.prototype.handleEvent=function(t){return!t.pointerEvent||(this.lastPointerEvent_=t,t.map.getView().getInteracting()||t.type!=a.Z.POINTERMOVE||this.handlingDownUpSequence||this.handlePointerMove_(t),this.vertexFeature_&&this.deleteCondition_(t)&&(r=!(t.type!=a.Z.SINGLECLICK||!this.ignoreNextSingleClick_)||this.removePoint()),t.type==a.Z.SINGLECLICK&&(this.ignoreNextSingleClick_=!1),e.prototype.handleEvent.call(this,t)&&!r);var r},t.prototype.handleDragEvent=function(e){this.ignoreNextSingleClick_=!1,this.willModifyFeatures_(e);for(var t=e.coordinate,r=0,i=this.dragSegments_.length;r<i;++r){for(var n=this.dragSegments_[r],o=n[0],s=o.depth,a=o.geometry,h=void 0,l=o.segment,g=n[1];t.length<a.getStride();)t.push(l[g][t.length]);switch(a.getType()){case c.Z.POINT:h=t,l[0]=l[1]=t;break;case c.Z.MULTI_POINT:(h=a.getCoordinates())[o.index]=t,l[0]=l[1]=t;break;case c.Z.LINE_STRING:(h=a.getCoordinates())[o.index+g]=t,l[g]=t;break;case c.Z.MULTI_LINE_STRING:case c.Z.POLYGON:(h=a.getCoordinates())[s[0]][o.index+g]=t,l[g]=t;break;case c.Z.MULTI_POLYGON:(h=a.getCoordinates())[s[1]][s[0]][o.index+g]=t,l[g]=t;break;case c.Z.CIRCLE:l[0]=l[1]=t,0===o.index?(this.changingFeature_=!0,a.setCenter(t),this.changingFeature_=!1):(this.changingFeature_=!0,a.setRadius((0,u.TE)(a.getCenter(),t)),this.changingFeature_=!1)}h&&this.setGeometryCoordinates_(a,h)}this.createOrUpdateVertexFeature_(t)},t.prototype.handleDownEvent=function(e){if(!this.condition_(e))return!1;this.handlePointerAtPixel_(e.pixel,e.map);var t=e.map.getCoordinateFromPixel(e.pixel);this.dragSegments_.length=0,this.modified_=!1;var r=this.vertexFeature_;if(r){var n=[],o=r.getGeometry().getCoordinates(),s=(0,p.hI)([o]),a=this.rBush_.getInExtent(s),h={};a.sort(T);for(var l=0,g=a.length;l<g;++l){var _=a[l],d=_.segment,f=(0,i.sq)(_.feature),v=_.depth;if(v&&(f+="-"+v.join("-")),h[f]||(h[f]=new Array(2)),_.geometry.getType()===c.Z.CIRCLE&&1===_.index){var m=G(t,_);(0,u.fS)(m,o)&&!h[f][0]&&(this.dragSegments_.push([_,0]),h[f][0]=_)}else if((0,u.fS)(d[0],o)&&!h[f][0])this.dragSegments_.push([_,0]),h[f][0]=_;else if((0,u.fS)(d[1],o)&&!h[f][1]){if((_.geometry.getType()===c.Z.LINE_STRING||_.geometry.getType()===c.Z.MULTI_LINE_STRING)&&h[f][0]&&0===h[f][0].index)continue;this.dragSegments_.push([_,1]),h[f][1]=_}else this.insertVertexCondition_(e)&&(0,i.sq)(d)in this.vertexSegments_&&!h[f][0]&&!h[f][1]&&n.push([_,o])}n.length&&this.willModifyFeatures_(e);for(var y=n.length-1;y>=0;--y)this.insertVertex_.apply(this,n[y])}return!!this.vertexFeature_},t.prototype.handleUpEvent=function(e){for(var t=this.dragSegments_.length-1;t>=0;--t){var r=this.dragSegments_[t][0],i=r.geometry;if(i.getType()===c.Z.CIRCLE){var n=i.getCenter(),o=r.featureSegments[0],s=r.featureSegments[1];o.segment[0]=o.segment[1]=n,s.segment[0]=s.segment[1]=n,this.rBush_.update((0,p.HK)(n),o),this.rBush_.update(i.getExtent(),s)}else this.rBush_.update((0,p.hI)(r.segment),r)}return this.modified_&&(this.dispatchEvent(new S(F,this.features_,e)),this.modified_=!1),!1},t.prototype.handlePointerMove_=function(e){this.lastPixel_=e.pixel,this.handlePointerAtPixel_(e.pixel,e.map)},t.prototype.handlePointerAtPixel_=function(e,t){var r=t.getCoordinateFromPixel(e),n=(0,p.f3)((0,p.HK)(r),t.getView().getResolution()*this.pixelTolerance_),o=this.rBush_.getInExtent(n);if(o.length>0){o.sort((function(e,t){return I(r,e)-I(r,t)}));var s=o[0],a=s.segment,h=G(r,s),l=t.getPixelFromCoordinate(h),g=(0,u.TE)(e,l);if(g<=this.pixelTolerance_){var _={};if(s.geometry.getType()===c.Z.CIRCLE&&1===s.index)this.snappedToVertex_=!0,this.createOrUpdateVertexFeature_(h);else{var d=t.getPixelFromCoordinate(a[0]),f=t.getPixelFromCoordinate(a[1]),v=(0,u.bI)(l,d),m=(0,u.bI)(l,f);g=Math.sqrt(Math.min(v,m)),this.snappedToVertex_=g<=this.pixelTolerance_,this.snappedToVertex_&&(h=v>m?a[1]:a[0]),this.createOrUpdateVertexFeature_(h);for(var y=1,x=o.length;y<x;++y){var E=o[y].segment;if(!((0,u.fS)(a[0],E[0])&&(0,u.fS)(a[1],E[1])||(0,u.fS)(a[0],E[1])&&(0,u.fS)(a[1],E[0])))break;_[(0,i.sq)(E)]=!0}}return _[(0,i.sq)(a)]=!0,void(this.vertexSegments_=_)}}this.vertexFeature_&&(this.overlay_.getSource().removeFeature(this.vertexFeature_),this.vertexFeature_=null)},t.prototype.insertVertex_=function(e,t){for(var r,i=e.segment,n=e.feature,o=e.geometry,s=e.depth,a=e.index;t.length<o.getStride();)t.push(0);switch(o.getType()){case c.Z.MULTI_LINE_STRING:case c.Z.POLYGON:(r=o.getCoordinates())[s[0]].splice(a+1,0,t);break;case c.Z.MULTI_POLYGON:(r=o.getCoordinates())[s[1]][s[0]].splice(a+1,0,t);break;case c.Z.LINE_STRING:(r=o.getCoordinates()).splice(a+1,0,t);break;default:return}this.setGeometryCoordinates_(o,r);var h=this.rBush_;h.remove(e),this.updateSegmentIndices_(o,a,s,1);var u={segment:[i[0],t],feature:n,geometry:o,depth:s,index:a};h.insert((0,p.hI)(u.segment),u),this.dragSegments_.push([u,1]);var l={segment:[t,i[1]],feature:n,geometry:o,depth:s,index:a+1};h.insert((0,p.hI)(l.segment),l),this.dragSegments_.push([l,0]),this.ignoreNextSingleClick_=!0},t.prototype.removePoint=function(){if(this.lastPointerEvent_&&this.lastPointerEvent_.type!=a.Z.POINTERDRAG){var e=this.lastPointerEvent_;return this.willModifyFeatures_(e),this.removeVertex_(),this.dispatchEvent(new S(F,this.features_,e)),this.modified_=!1,!0}return!1},t.prototype.removeVertex_=function(){var e,t,r,n,o,s,a,h,u,l,g,_=this.dragSegments_,d={},f=!1;for(o=_.length-1;o>=0;--o)l=(r=_[o])[0],g=(0,i.sq)(l.feature),l.depth&&(g+="-"+l.depth.join("-")),g in d||(d[g]={}),0===r[1]?(d[g].right=l,d[g].index=l.index):1==r[1]&&(d[g].left=l,d[g].index=l.index+1);for(g in d){switch(u=d[g].right,a=d[g].left,(h=(s=d[g].index)-1)<0&&(h=0),e=t=(n=(l=void 0!==a?a:u).geometry).getCoordinates(),f=!1,n.getType()){case c.Z.MULTI_LINE_STRING:t[l.depth[0]].length>2&&(t[l.depth[0]].splice(s,1),f=!0);break;case c.Z.LINE_STRING:t.length>2&&(t.splice(s,1),f=!0);break;case c.Z.MULTI_POLYGON:e=e[l.depth[1]];case c.Z.POLYGON:(e=e[l.depth[0]]).length>4&&(s==e.length-1&&(s=0),e.splice(s,1),f=!0,0===s&&(e.pop(),e.push(e[0]),h=e.length-1))}if(f){this.setGeometryCoordinates_(n,t);var v=[];if(void 0!==a&&(this.rBush_.remove(a),v.push(a.segment[0])),void 0!==u&&(this.rBush_.remove(u),v.push(u.segment[1])),void 0!==a&&void 0!==u){var m={depth:l.depth,feature:l.feature,geometry:l.geometry,index:h,segment:v};this.rBush_.insert((0,p.hI)(m.segment),m)}this.updateSegmentIndices_(n,s,l.depth,-1),this.vertexFeature_&&(this.overlay_.getSource().removeFeature(this.vertexFeature_),this.vertexFeature_=null),_.length=0}}return f},t.prototype.setGeometryCoordinates_=function(e,t){this.changingFeature_=!0,e.setCoordinates(t),this.changingFeature_=!1},t.prototype.updateSegmentIndices_=function(e,t,r,i){this.rBush_.forEachInExtent(e.getExtent(),(function(n){n.geometry===e&&(void 0===r||void 0===n.depth||(0,h.fS)(n.depth,r))&&n.index>t&&(n.index+=i)}))},t}(v.Z)},650141:(e,t,r)=>{"use strict";r.d(t,{Z:()=>m});var i=r(949179),n=r(919629),o=r(690728),s=r(613002),a=r(173381),h=r(421915),u=r(864011),l=r(28795),g=r(640353),_=r(938024),d=r(913580),p=r(925753),c=r(273101);function f(e){return e.feature?e.feature:e.element?e.element:void 0}function v(e,t){return(0,o.Bs)(this.pixelCoordinate_,e.segment)-(0,o.Bs)(this.pixelCoordinate_,t.segment)}const m=function(e){function t(t){var r=t||{},i=r;i.handleDownEvent||(i.handleDownEvent=u.uX),i.stopDown||(i.stopDown=u.Dv),e.call(this,i),this.source_=r.source?r.source:null,this.vertex_=void 0===r.vertex||r.vertex,this.edge_=void 0===r.edge||r.edge,this.features_=r.features?r.features:null,this.featuresListenerKeys_=[],this.featureChangeListenerKeys_={},this.indexedFeaturesExtents_={},this.pendingFeatures_={},this.pixelCoordinate_=null,this.pixelTolerance_=void 0!==r.pixelTolerance?r.pixelTolerance:10,this.sortByDistance_=v.bind(this),this.rBush_=new c.Z,this.SEGMENT_WRITERS_={Point:this.writePointGeometry_,LineString:this.writeLineStringGeometry_,LinearRing:this.writeLineStringGeometry_,Polygon:this.writePolygonGeometry_,MultiPoint:this.writeMultiPointGeometry_,MultiLineString:this.writeMultiLineStringGeometry_,MultiPolygon:this.writeMultiPolygonGeometry_,GeometryCollection:this.writeGeometryCollectionGeometry_,Circle:this.writeCircleGeometry_}}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.addFeature=function(e,t){var r=void 0===t||t,n=(0,i.sq)(e),o=e.getGeometry();if(o){var u=this.SEGMENT_WRITERS_[o.getType()];u&&(this.indexedFeaturesExtents_[n]=o.getExtent((0,h.lJ)()),u.call(this,e,o))}r&&(this.featureChangeListenerKeys_[n]=(0,s.oL)(e,a.Z.CHANGE,this.handleFeatureChange_,this))},t.prototype.forEachFeatureAdd_=function(e){this.addFeature(e)},t.prototype.forEachFeatureRemove_=function(e){this.removeFeature(e)},t.prototype.getFeatures_=function(){var e;return this.features_?e=this.features_:this.source_&&(e=this.source_.getFeatures()),e},t.prototype.handleEvent=function(t){var r=this.snapTo(t.pixel,t.coordinate,t.map);return r.snapped&&(t.coordinate=r.vertex.slice(0,2),t.pixel=r.vertexPixel),e.prototype.handleEvent.call(this,t)},t.prototype.handleFeatureAdd_=function(e){var t=f(e);this.addFeature(t)},t.prototype.handleFeatureRemove_=function(e){var t=f(e);this.removeFeature(t)},t.prototype.handleFeatureChange_=function(e){var t=e.target;if(this.handlingDownUpSequence){var r=(0,i.sq)(t);r in this.pendingFeatures_||(this.pendingFeatures_[r]=t)}else this.updateFeature_(t)},t.prototype.handleUpEvent=function(e){var t=(0,d.KX)(this.pendingFeatures_);return t.length&&(t.forEach(this.updateFeature_.bind(this)),this.pendingFeatures_={}),!1},t.prototype.removeFeature=function(e,t){var r=void 0===t||t,n=(0,i.sq)(e),o=this.indexedFeaturesExtents_[n];if(o){var a=this.rBush_,h=[];a.forEachInExtent(o,(function(t){e===t.feature&&h.push(t)}));for(var u=h.length-1;u>=0;--u)a.remove(h[u])}r&&((0,s.bN)(this.featureChangeListenerKeys_[n]),delete this.featureChangeListenerKeys_[n])},t.prototype.setMap=function(t){var r=this.getMap(),i=this.featuresListenerKeys_,o=this.getFeatures_();r&&(i.forEach(s.bN),i.length=0,o.forEach(this.forEachFeatureRemove_.bind(this))),e.prototype.setMap.call(this,t),t&&(this.features_?i.push((0,s.oL)(this.features_,n.Z.ADD,this.handleFeatureAdd_,this),(0,s.oL)(this.features_,n.Z.REMOVE,this.handleFeatureRemove_,this)):this.source_&&i.push((0,s.oL)(this.source_,p.Z.ADDFEATURE,this.handleFeatureAdd_,this),(0,s.oL)(this.source_,p.Z.REMOVEFEATURE,this.handleFeatureRemove_,this)),o.forEach(this.forEachFeatureAdd_.bind(this)))},t.prototype.snapTo=function(e,t,r){var i=r.getCoordinateFromPixel([e[0]-this.pixelTolerance_,e[1]+this.pixelTolerance_]),n=r.getCoordinateFromPixel([e[0]+this.pixelTolerance_,e[1]-this.pixelTolerance_]),s=(0,h.hI)([i,n]),a=this.rBush_.getInExtent(s);this.vertex_&&!this.edge_&&(a=a.filter((function(e){return e.feature.getGeometry().getType()!==l.Z.CIRCLE})));var u,g,_,d,p=!1,c=null,f=null;if(a.length>0){this.pixelCoordinate_=t,a.sort(this.sortByDistance_);var v=a[0].segment,m=a[0].feature.getGeometry().getType()===l.Z.CIRCLE;this.vertex_&&!this.edge_?(u=r.getPixelFromCoordinate(v[0]),g=r.getPixelFromCoordinate(v[1]),_=(0,o.bI)(e,u),d=(0,o.bI)(e,g),Math.sqrt(Math.min(_,d))<=this.pixelTolerance_&&(p=!0,c=_>d?v[1]:v[0],f=r.getPixelFromCoordinate(c))):this.edge_&&(c=m?(0,o.Ed)(t,a[0].feature.getGeometry()):(0,o.oL)(t,v),f=r.getPixelFromCoordinate(c),(0,o.TE)(e,f)<=this.pixelTolerance_&&(p=!0,this.vertex_&&!m&&(u=r.getPixelFromCoordinate(v[0]),g=r.getPixelFromCoordinate(v[1]),_=(0,o.bI)(f,u),d=(0,o.bI)(f,g),Math.sqrt(Math.min(_,d))<=this.pixelTolerance_&&(c=_>d?v[1]:v[0],f=r.getPixelFromCoordinate(c))))),p&&(f=[Math.round(f[0]),Math.round(f[1])])}return{snapped:p,vertex:c,vertexPixel:f}},t.prototype.updateFeature_=function(e){this.removeFeature(e,!1),this.addFeature(e,!1)},t.prototype.writeCircleGeometry_=function(e,t){for(var r=(0,g.Bb)(t).getCoordinates()[0],i=0,n=r.length-1;i<n;++i){var o=r.slice(i,i+2),s={feature:e,segment:o};this.rBush_.insert((0,h.hI)(o),s)}},t.prototype.writeGeometryCollectionGeometry_=function(e,t){for(var r=t.getGeometriesArray(),i=0;i<r.length;++i){var n=this.SEGMENT_WRITERS_[r[i].getType()];n&&n.call(this,e,r[i])}},t.prototype.writeLineStringGeometry_=function(e,t){for(var r=t.getCoordinates(),i=0,n=r.length-1;i<n;++i){var o=r.slice(i,i+2),s={feature:e,segment:o};this.rBush_.insert((0,h.hI)(o),s)}},t.prototype.writeMultiLineStringGeometry_=function(e,t){for(var r=t.getCoordinates(),i=0,n=r.length;i<n;++i)for(var o=r[i],s=0,a=o.length-1;s<a;++s){var u=o.slice(s,s+2),l={feature:e,segment:u};this.rBush_.insert((0,h.hI)(u),l)}},t.prototype.writeMultiPointGeometry_=function(e,t){for(var r=t.getCoordinates(),i=0,n=r.length;i<n;++i){var o=r[i],s={feature:e,segment:[o,o]};this.rBush_.insert(t.getExtent(),s)}},t.prototype.writeMultiPolygonGeometry_=function(e,t){for(var r=t.getCoordinates(),i=0,n=r.length;i<n;++i)for(var o=r[i],s=0,a=o.length;s<a;++s)for(var u=o[s],l=0,g=u.length-1;l<g;++l){var _=u.slice(l,l+2),d={feature:e,segment:_};this.rBush_.insert((0,h.hI)(_),d)}},t.prototype.writePointGeometry_=function(e,t){var r=t.getCoordinates(),i={feature:e,segment:[r,r]};this.rBush_.insert(t.getExtent(),i)},t.prototype.writePolygonGeometry_=function(e,t){for(var r=t.getCoordinates(),i=0,n=r.length;i<n;++i)for(var o=r[i],s=0,a=o.length-1;s<a;++s){var u=o.slice(s,s+2),l={feature:e,segment:u};this.rBush_.insert((0,h.hI)(u),l)}},t}(_.Z)}}]);